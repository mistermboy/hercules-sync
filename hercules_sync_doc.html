

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Hercules synchronization module architecture &mdash; hercules_sync  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Documentation of the hercules_sync system" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> hercules_sync
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hercules synchronization module architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction-and-goals">Introduction and Goals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements-overview">Requirements Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quality-goals">Quality Goals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stakeholders">Stakeholders</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#architecture-constraints">Architecture Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="#system-scope-and-context">System Scope and Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solution-strategy">Solution Strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-block-view">Building Block View</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#whitebox-hercules-sync">Whitebox hercules_sync</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#contained-blackboxes">Contained Blackboxes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#level-2">Level 2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#listener">Listener</a></li>
<li class="toctree-l4"><a class="reference internal" href="#diff-processor">Diff Processor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ontology-synchronizer">Ontology Synchronizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#triple-store-manager">Triple-Store Manager</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#runtime-view">Runtime View</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-new-triple-to-the-triple-store">Create a new triple to the triple store</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deployment-view">Deployment View</a></li>
<li class="toctree-l2"><a class="reference internal" href="#technical-and-cross-cutting-concepts">Technical and Cross-cutting Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#technologies-used">Technologies used</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#python">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#flask">Flask</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wikidataintegrator">WikidataIntegrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytest">Pytest</a></li>
<li class="toctree-l4"><a class="reference internal" href="#travis">Travis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#codacy">Codacy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#continuous-integration">Continuous integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#style-guides">Style guides</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#design-decisions">Design Decisions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adapter-pattern-changing-the-triple-store-implementation">Adapter pattern: Changing the triple-store implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#risks-and-technical-debts">Risks and Technical Debts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests">Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#design-phase">Design phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-phase">Implementation phase</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#requirements-analysis">Requirements analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#functional-requirements">Functional requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#non-functional-requirements">Non-functional requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#annexes">Annexes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-integracion-de-sistema-de-sincronizacion-con-github">A: Integración de sistema de sincronización con GitHub</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creacion-del-webhook">Creación del webhook</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creacion-del-token-de-acceso-personal">Creación del token de acceso personal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuracion-del-token-de-acceso">Configuración del token de acceso</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#b-system-manual">B: System manual</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#defining-a-webhook-in-the-source-repo">Defining a webhook in the source repo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#launching-the-app-with-docker">Launching the app with Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#glossary">Glossary</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hercules_sync</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Hercules synchronization module architecture</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/hercules_sync_doc.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><img alt="_images/logos_feder.png" src="_images/logos_feder.png" /></p>
<div class="section" id="hercules-synchronization-module-architecture">
<h1>Hercules synchronization module architecture<a class="headerlink" href="#hercules-synchronization-module-architecture" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p><strong>Note: Web Version</strong> <br>
This document is accesible through a web interface through the following URL: http://www.weso.es/hercules-sync/. Additional information, such as the documentation generated from the source code, can also be accessed there.</p>
</div></blockquote>
<div class="section" id="introduction-and-goals">
<h2>Introduction and Goals<a class="headerlink" href="#introduction-and-goals" title="Permalink to this headline">¶</a></h2>
<p>This document includes the architectural documentation for the synchronization module - from now on called <em>hercules_sync</em> - between ontology files and a triple-store, whis is a part of the ontological infrastructure of Project Hércules.</p>
<p>The structure of this document follows the <a class="reference external" href="https://arc42.org/">arc42</a> template for documentation of software and systems architectures.</p>
<div class="section" id="requirements-overview">
<h3>Requirements Overview<a class="headerlink" href="#requirements-overview" title="Permalink to this headline">¶</a></h3>
<p>The overall goal of <em>hercules_sync</em> is to synchronize ontologies content between files hosted in a version control system and a triplestore where the content is stored.</p>
<p>A more complete analysis of the system’s requirements can be found in the <strong>Requirements analysis</strong> section.</p>
</div>
<div class="section" id="quality-goals">
<h3>Quality Goals<a class="headerlink" href="#quality-goals" title="Permalink to this headline">¶</a></h3>
<p>In this section we will enumerate the top quality goals for the system’s architecture:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Priority</th>
<th>Goal</th>
<th>Scenario</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Consistency</td>
<td>Changes to the ontology should be completely reflected in the triplstore. Both the triple store and the ontology should have the same information.</td>
</tr>
<tr>
<td>1</td>
<td> Flexibility</td>
<td>Although the initial implementation of the system will work through the BlazeGraph triple store of Wikibase, the triple store where the changes will be propagated to should be easily extended.</td>
</tr>
<tr>
<td>1</td>
<td>Fault Tolerance</td>
<td>In case that one of the components that surround the synchronization system fails, the system must be able to continue working and keep the other quality goals whenever possible.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="stakeholders">
<h3>Stakeholders<a class="headerlink" href="#stakeholders" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th>Role/Name</th>
<th>Description</th>
<th>Expectations</th>
</tr>
</thead>
<tbody>
<tr>
<td>Domain Experts</td>
<td>User that modifies the content of the ontology through the user interface provided by the ontology publication service.</td>
<td>When a change is made through the user interface, the content of the ontologies in the version control system should be consistent with these changes.</td>
</tr>
<tr>
<td>Ontology Engineer</td>
<td>User that modifies the content of the ontology directly from the version control system.</td>
<td>Once a ontology file is modified, the changes should be reflected in the triplestore.</td>
</tr>
</tbody>
</table></div>
</div>
<div class="section" id="architecture-constraints">
<h2>Architecture Constraints<a class="headerlink" href="#architecture-constraints" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">Contraint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">C1</td>
<td>The system must be developed under the <a href="https://www.gnu.org/licenses/gpl-3.0.html">GNU General Public License v3.0</a>.</td>
</tr>
<tr>
<td align="center">C2</td>
<td>The system must be platform-independent and should run on the major operating systems (Windows™, Linux, and Mac-OS™).</td>
</tr>
<tr>
<td align="center">C3</td>
<td>The system must be runnable from the command line.</td>
</tr>
<tr>
<td align="center">C4</td>
<td>The control versions system used to store the ontologies will be git based.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="system-scope-and-context">
<h2>System Scope and Context<a class="headerlink" href="#system-scope-and-context" title="Permalink to this headline">¶</a></h2>
<p>Domain experts have the domain knowledge necessary to contribute to some of the domain-specific ontologies that they are used to work in. However, not all of them have the necessary expertise in the technologies surrounding the RDF ecosystem (OWL, SPARQL, the different syntaxes…).</p>
<p>Wikibase is the powerful, flexible and customizable knowledge base software that drives Wikidata. With MediaWiki as its front end and a rich JavaScript interface for data management, Wikibase makes collaboration easy for humans and machines alike, and its data model prioritizes language independence and knowledge diversity.</p>
<p>Wikibase’s robust data export options include JSON, RDF/XML, N3, YAML and more — and it provides a powerful query interface using SPARQL for both local and federated queries (with updates on changes), extending the potential data available from a single node to thousands.</p>
<p>With Wikibase we can bridge the gap between Ontology engineers who work directly on the ontology files, and other domain experts that can contribute directly to the ontology through the Wikibase interface but don’t have the necessary knowledge to modify the files directly.</p>
<p>However, we still need to reflect the changes that occur in the wikibase or ontology to their counterpart. This is when the need to create a system that can propagate changes of an ontology to a triple store appears.</p>
<p>This system need not be just fixed to work with Wikibase (and its triplestore, Blazegraph). The idea is to provide a system that could work with different triplestores where the ontology would be synchronized.</p>
</div>
<div class="section" id="solution-strategy">
<h2>Solution Strategy<a class="headerlink" href="#solution-strategy" title="Permalink to this headline">¶</a></h2>
<p>The solution to the problem stated above is the creation of a REST API which will be in charge of propagating these changes. There are two possible types of propagations that can occur:</p>
<ul class="simple">
<li><p>A change happens to the ontology files. This change must be propagated to the triple store where the ontology is stored.</p></li>
<li><p>A change occurs in the triple store. This change must be propagated to the ontology files through the version control system.</p></li>
</ul>
<p>Once a new release is created in the version control system, a REST endpoint provided by hercules_sync will be automatically called through the use of <a class="reference external" href="https://developer.github.com/webhooks/">GitHub webhooks</a>. In this request the diff will be sent and propagated to the underlying triple store.</p>
</div>
<div class="section" id="building-block-view">
<h2>Building Block View<a class="headerlink" href="#building-block-view" title="Permalink to this headline">¶</a></h2>
<p>The building block view shows the static decomposition of the system into building blocks (modules, components, subsystems, classes, interfaces, packages, libraries, frameworks, layers, partitions, tiers, functions, macros, operations, datas structures, …) as well as their dependencies (relationships, associations, …).</p>
<p>The following diagram shows the static decomposition of the system into building blocks:</p>
<p><img alt="_images/herc_sync_bbview.png" src="_images/herc_sync_bbview.png" /></p>
<p>We will now briefly describe the main elements that compose this view.</p>
<div class="section" id="whitebox-hercules-sync">
<h3>Whitebox hercules_sync<a class="headerlink" href="#whitebox-hercules-sync" title="Permalink to this headline">¶</a></h3>
<div class="section" id="contained-blackboxes">
<h4>Contained Blackboxes<a class="headerlink" href="#contained-blackboxes" title="Permalink to this headline">¶</a></h4>
<p>The following components and interfaces have been detected:</p>
<ul class="simple">
<li><p>listener: This component is the entrypoint of the subsystem that other external systems will use. To do so, it offers an external interface - named OnWebhook - which is in charge of receiving the data about the ontology updates from the version control system.</p></li>
<li><p>ontology_synchronizer: This component performs the synchronization of the received changes, creating new operations to perform on the triple store to propagate these changes. It offers an interface named <em>SynchronizeOntologies</em>, which is used by the listener component to synchronize the received changes.</p></li>
<li><p>diff_parser: The <em>diff_parser</em> component is in charge of processing the usual diff information about each file used in git-based version control systems. It offers a <em>ParseDiff</em> interface, which is used by the <em>ontology_synchronizer</em> component to obtain detailed information about the changes made in the ontology files.</p></li>
<li><p>triplestore_manager: Lastly, the <em>triplestore_manager</em> component is in charge of executing the operations received from the <em>ontology_synchronizer</em> component to the chosen triple-store. It provides the <em>ExecuteModification</em> interface to accomplish this.</p></li>
</ul>
</div>
</div>
<div class="section" id="level-2">
<h3>Level 2<a class="headerlink" href="#level-2" title="Permalink to this headline">¶</a></h3>
<p>In this level we will detail each one of the previous building blocks of the system identified in level 1.</p>
<blockquote>
<div><p><strong>Python singularities</strong>. <br>
Since Python is a dynamically typed language that lacks some of the constructs of other programming languages, such as Interfaces, we will be making the following distinctions in the UML diagrams:</p>
<ul class="simple">
<li><p>Python modules which are just composed of functions, and do not have any classes inside, will be treated as static classes in the UML diagrams.</p></li>
<li><p>Since access modifiers don’t exist in Python, we used the convention that underscored fields and funtions are considered private. These items will be shown as private in the UML diagrams.</p></li>
<li><p>Since there are no interfaces in Python, we will represent as an interface abstract classes that do not have any field or implemented method.</p></li>
<li><p>Multiple inheritance is possible in Python, so there could be cases in the UML diagrams where a class extends multiple classes.</p></li>
</ul>
<p>Also, it’s important to note that Python relies in duck typing rather than in implementation of interfaces. However, we still opted to create ”pseudo-interfaces” (abstract classes with no fields or implemented methods) and extend them by other classes. This was done in order to specify explicitly that a class followed a given interface, rather than implicitly by checking at the methods that it provides internally.</p>
</div></blockquote>
<div class="section" id="listener">
<h4>Listener<a class="headerlink" href="#listener" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Listener: The listener class initializes a flask server through the AppFactory, and establishes the entrypoint where information about the ontologies’ updates will be received.</p></li>
<li><p>Webhook: This class manages the communication with the control version system through Webhooks (for more information about webhooks, see https://developer.github.com/webhooks/) in a safe manner with the use of RSA keys.</p></li>
<li><p>AppFactory: Factory class that creates the Flask application given a specific server configuration.</p></li>
<li><p>Config: Configuration class to be used by the server.</p></li>
</ul>
<p><img alt="_images/herc_sync_listener_classes.png" src="_images/herc_sync_listener_classes.png" /></p>
</div>
<div class="section" id="diff-processor">
<h4>Diff Processor<a class="headerlink" href="#diff-processor" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>PushEventHandler: Main class used by the listener to process all the received information about incoming changes from the ontologies.</p></li>
<li><p>PushInfo: Information about the data received from the control version system.</p></li>
<li><p>GitDiffParser: This class is in charge of parsing the diff about each file changed and return the lines that were modified in each file.</p></li>
<li><p>GitDataLoader: The GitDataLoader class will download the content of each file before and after the modifications were done.</p></li>
<li><p>GitFile: Wrapper which stores the content of a modified file before and after the modification, as well as other metadata about the file.</p></li>
</ul>
<p><img alt="_images/herc_sync_diff_parser_classes.png" src="_images/herc_sync_diff_parser_classes.png" /></p>
</div>
<div class="section" id="ontology-synchronizer">
<h4>Ontology Synchronizer<a class="headerlink" href="#ontology-synchronizer" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>OntologySynchronizer: This class receives the synchronization algorithm to be used and returns a list of operations to perform on the triple-store to reflect the current modifications from the ontology files.</p></li>
<li><p>SyncAlgorithm: Interface to be implemented by each one of the synchronization algorithms. These algorithms receive the modified lines from each file and return the list of operations to be made.</p></li>
<li><p>NaiveSync: Simple synchronization algorithms that overwrites the content of the triple-store to be consistent with the current state of the ontology files.</p></li>
<li><p>RDFSync: <a class="reference external" href="https://link.springer.com/content/pdf/10.1007%2F978-3-540-76298-0_39.pdf">RDFSync</a> algorithm for the synchronization of RDF files.</p></li>
<li><p>SyncOperation: Abstract class that represents the operation to be made in the triple-store.</p></li>
</ul>
<p><img alt="_images/herc_sync_ontologies_synchronizer_classes.png" src="_images/herc_sync_ontologies_synchronizer_classes.png" /></p>
</div>
<div class="section" id="triple-store-manager">
<h4>Triple-Store Manager<a class="headerlink" href="#triple-store-manager" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>TripleStoreManager: Interface to be implemented by each one of the adapters that will connect to a specific triple-store.</p></li>
<li><p>WikibaseAdapter: Adapter that connects to a BlazeGraph triple-store configured in a wikibase instance.</p></li>
<li><p>ModificationResult: Class which encapsulates the result of a modification performed on a triple-store.</p></li>
</ul>
<p><img alt="_images/herc_sync_triplestore_manager_classes.png" src="_images/herc_sync_triplestore_manager_classes.png" /></p>
</div>
</div>
</div>
<div class="section" id="runtime-view">
<h2>Runtime View<a class="headerlink" href="#runtime-view" title="Permalink to this headline">¶</a></h2>
<p>In this section we will show an example runtime view of the system, where a new triple will be added to the underlying triple store.</p>
<div class="section" id="create-a-new-triple-to-the-triple-store">
<h3>Create a new triple to the triple store<a class="headerlink" href="#create-a-new-triple-to-the-triple-store" title="Permalink to this headline">¶</a></h3>
<p>The following diagram illustrates the sequence of events that occur when adding a new triple to the underlying triple store. This sequence diagram begins after the diff has already been processed and a creation operation is executed by the <em>Ontology_Synchronizer</em> component:
<img alt="_images/herc_sync_sequence_new_triple.png" src="_images/herc_sync_sequence_new_triple.png" /></p>
</div>
</div>
<div class="section" id="deployment-view">
<h2>Deployment View<a class="headerlink" href="#deployment-view" title="Permalink to this headline">¶</a></h2>
<p>The following image describes the deployment view of the system. The following elements have been identified:</p>
<ul class="simple">
<li><p>Webhook (GitHub): This corresponds to the webhook system that is automatically managed by GitHub. This system runs on an external machine and will call the synchronization system through the 5000/tcp port.</p></li>
<li><p>ontology_synchronizer: This system will be deployed in a production machine using a docker container, it will receive requests from the webhook with the changes from the ontology files. It will also communicate with wikibase to propagate the modifications from the ontology and with an external system, the URIS factory, to store and retrieve the Wikibase URIs of the entities that will be updated.</p></li>
<li><p>wikibase: This component includes all of the containers available in the <a class="reference external" href="https://github.com/wmde/wikibase-docker">wikibase-docker</a> repository which form part of a Wikibase instance.</p></li>
<li><p>uris_factory: External system that is in charge of managing the URIs associated to each element of the ontology.
<img alt="_images/herc_sync_deployment_view.png" src="_images/herc_sync_deployment_view.png" /></p></li>
</ul>
</div>
<div class="section" id="technical-and-cross-cutting-concepts">
<h2>Technical and Cross-cutting Concepts<a class="headerlink" href="#technical-and-cross-cutting-concepts" title="Permalink to this headline">¶</a></h2>
<p>In this section we will specify some of the technical constraints of the project.</p>
<div class="section" id="technologies-used">
<h3>Technologies used<a class="headerlink" href="#technologies-used" title="Permalink to this headline">¶</a></h3>
<p>The following technologies have been used in the development of the system.</p>
<div class="section" id="python">
<h4>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h4>
<p>The main programming language used for the module implementation is <a class="reference external" href="https://www.python.org">Python</a>. Python is a interpreted, high level and general purpose language designed by Guido van Rossum in 1991. It is characterized by its legible syntax and dynamic typing.</p>
<p>Python was chosen for the implementation of this module since it provides a wide ecosystem of libraries that allow working with ontologies and triple stores compared to other languages.</p>
<p>This module will have compatibility with Python 3. Since January 1st of 2020 the end of cycle of Python 2 was announced, and Python 3 is the current maintained version.</p>
</div>
<div class="section" id="flask">
<h4>Flask<a class="headerlink" href="#flask" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://palletsprojects.com/p/flask/">Flask</a> is a web microframework based on the <a class="reference external" href="https://wsgi.readthedocs.io/en/latest/">WSGI</a> standard which focuses on flexibility and efficiency.</p>
<p>Flask will be used in <em>hercules_sync</em> to launch a web server that will listen to ontology updates coming from the control version system.</p>
</div>
<div class="section" id="wikidataintegrator">
<h4>WikidataIntegrator<a class="headerlink" href="#wikidataintegrator" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/SuLab/WikidataIntegrator">WikidataIntegrator</a> is a library that allows the creation and querying of entity data on a wikibase instance through the <a class="reference external" href="https://www.mediawiki.org/wiki/API:Main_page">MediaWiki API</a>.</p>
<p>This library is used to propagate the modifications made in the ontologies to the Wikibase instance and its underlying triple-store.</p>
</div>
<div class="section" id="pytest">
<h4>Pytest<a class="headerlink" href="#pytest" title="Permalink to this headline">¶</a></h4>
<p>Pytest is a framework that facilitates the implementation of tests in Python. It can be used to write simple tests, but also to write functional tests which are more complex. The testing libraries which come integrated in the own language, such as unittest and doctest, can be easily integrated with pytest.</p>
</div>
<div class="section" id="travis">
<h4>Travis<a class="headerlink" href="#travis" title="Permalink to this headline">¶</a></h4>
<p>Travis is a continuous integration service that can be used to monitor and test projects hosted in GitHub.</p>
</div>
<div class="section" id="codacy">
<h4>Codacy<a class="headerlink" href="#codacy" title="Permalink to this headline">¶</a></h4>
<p>Codacy is a static code analysis tool that allows the monitoring of quality in projects, and supports multiple programming languages. It returns several code quality metrics, regarding security, compatibility, performance and code style aspects.</p>
</div>
</div>
<div class="section" id="continuous-integration">
<h3>Continuous integration<a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h3>
<p>In the module repository we follow continuous integration practices in order to fulfill some of the non-functional requirements that need to be met. Before a new version of the module is pushed to the repository, a Travis build is launched where all the tests are executed. In order to be able to upload new changes to the master branch all tests need to pass, and both code coverage and quality returned by Codecov and Codacy must not drop below a given threshold.</p>
</div>
<div class="section" id="style-guides">
<h3>Style guides<a class="headerlink" href="#style-guides" title="Permalink to this headline">¶</a></h3>
<p>The main coding standard that was followed was the <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8</a> Python style guide. This standard specifies how code written in Python should be formatted (number of characters per line, import formats…) and is widely adopted in the community.</p>
<p>In order to document the code there are also several formatting styles that can be used. In our case, we opted to use the <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html">numpy docstring style</a> due to the readability it provides when compared to other alternatives.</p>
<p>### Other dependencies
Additional dependencies of the project are stored in the <a class="reference external" href="https://github.com/HerculesCRUE/ib-hercules-sync/blob/master/requirements.txt">requirements.txt file</a> from the herc_sync repository.</p>
</div>
</div>
<div class="section" id="design-decisions">
<h2>Design Decisions<a class="headerlink" href="#design-decisions" title="Permalink to this headline">¶</a></h2>
<p>In this section we will enumerate some of the design decisions made during the implementation of the system. Each decision originates from a given problem and gives the rationale behind it.</p>
<div class="section" id="adapter-pattern-changing-the-triple-store-implementation">
<h3>Adapter pattern: Changing the triple-store implementation<a class="headerlink" href="#adapter-pattern-changing-the-triple-store-implementation" title="Permalink to this headline">¶</a></h3>
<p>One of our initial goals of the system was that it should be easily extensible to use different underlying triple-stores. A naive approach would be to add an additional parameter to the execute method to indicate with the triple-store type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AdditionOperation</span><span class="p">(</span><span class="n">SyncOperation</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triple_store_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModificationResult</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">triple_store_type</span> <span class="o">==</span> <span class="s1">&#39;blazegraph&#39;</span><span class="p">:</span>
          <span class="c1"># do something with blazegraph</span>
        <span class="k">elif</span> <span class="n">triple_store_type</span> <span class="o">==</span> <span class="s1">&#39;....&#39;</span><span class="p">:</span>
          <span class="c1"># do something else with x</span>
        <span class="c1">#...</span>
</pre></div>
</div>
<p>Our solution to this was to define a common interface that all triple-stores must conform to. This interfaces provides an execute method that can then be called by each operation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TripleStoreManager</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Base class to execute operations on a triplestore.</span>

<span class="sd">    The methods of this class must be implemented by each specific triplestore</span>
<span class="sd">    adapter to allow the execution of SyncOperations on the triplestore.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">create_triple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triple_info</span><span class="p">:</span> <span class="n">TripleInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModificationResult</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Adds a new triple to the triplestore.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        triple_info : :obj:`TripleInfo`</span>
<span class="sd">            Triple that will be added to the triple store.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`ModificationResult`</span>
<span class="sd">            Result of the operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_triple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triple_info</span><span class="p">:</span> <span class="n">TripleInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModificationResult</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Remove a triple from the triplestore.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        triple_info : :obj:`TripleInfo`</span>
<span class="sd">            Triple that needs to be removed from the tripe store.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :obj:`ModificationResult`</span>
<span class="sd">            Result of the operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Then, each operation could be implemented like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AdditionOperation</span><span class="p">(</span><span class="n">SyncOperation</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triple_store</span><span class="p">:</span> <span class="n">TripleStoreManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModificationResult</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">triple_store</span><span class="o">.</span><span class="n">create_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_triple_info</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">RemovalOperation</span><span class="p">(</span><span class="n">SyncOperation</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">triple_store</span><span class="p">:</span> <span class="n">TripleStoreManager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModificationResult</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">triple_store</span><span class="o">.</span><span class="n">remove_triple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_triple_info</span><span class="p">)</span>
</pre></div>
</div>
<p>Now if we want to allow the propagation of changes to a new triple-store we would only need to create a new class when needed that provides the <em>create_triple</em> and <em>remove_triple</em> methods.</p>
</div>
</div>
<div class="section" id="risks-and-technical-debts">
<h2>Risks and Technical Debts<a class="headerlink" href="#risks-and-technical-debts" title="Permalink to this headline">¶</a></h2>
<p>In this section we will describe some of the risks associated to this system, and the solutions that have been proposed up to this date.</p>
<p>The main problem that arises with such a powerful and flexible system is that we need to take care with the problems that can arise when there is an act of vandalism or an error when making a change to the ontology.</p>
<p>We have considered two main solutions for this initial problem. The first solution is that the synchronization system is only called when a new release in GitHub is created. A release is supposed to be a new and stable version of the system after a series of modifications have been done. This means that most of these modifications have been validated by the repository administrators and errors have already been mostly removed.</p>
<p>However, since there is still a possibility that errors will go through this revision phase, Wikibase provides the capability of reverting each change made to the underlying triple-store, as shown in the ‘ASIO_Izertis_ControlDeVersionesOWL.md’ file. This means that even in the worst case where an error has gone through the revision process, there is still a possibility to roll back the changes to an error-free state.</p>
<p>The second problem that can arise is that when a change is made to the ontology there is a possibility that the underlying data that depends on it goes to a non-consistent state and needs to be updated. This is a problem that we are still currently considering, in our process of merging the pieces of the Ontological Infrastructure and the Semantic Architecture. One of our initial ideas is that the uris_factory component will play a crucial part in this propagation of changes, since it will store an historial of the URIs that each entity will have and we can update it if needed when breaking modifications are made. Another alternative is to keep a removed/modified entity and/or statement in Wikibase and mark it as deprecated. The newest version would be isolated and could be used by other consumers, while the deprecated clases and properties could still be used without needing further changes in other servicies that were already using them before the new releases were made. The Level 4 detailed in the OWL Version Control deliverable would play a crucial part here, since each element in Wikibase could have additional metadata with the version where it was introduced and the one where it became deprecated.</p>
</div>
<div class="section" id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h2>
<div class="section" id="design-phase">
<h3>Design phase<a class="headerlink" href="#design-phase" title="Permalink to this headline">¶</a></h3>
<p>In order to test this module the following techniques will be used:</p>
<ul class="simple">
<li><p>Static techniques:</p>
<ul>
<li><p>Static code analysis tools.</p></li>
</ul>
</li>
<li><p>Dynamic techniques:</p>
<ul>
<li><p>Specification-based, with equivalence class partitioning.</p></li>
</ul>
</li>
</ul>
<p>These techniques were selected mainly due to the nature of the system (there is no graphical interface, so other static techniques were more difficult to use) and also due to the experience of the development team testing related systems (experience based techniques were not appropriate for this context).</p>
</div>
<div class="section" id="implementation-phase">
<h3>Implementation phase<a class="headerlink" href="#implementation-phase" title="Permalink to this headline">¶</a></h3>
<p>After the design phase was concluded, these are some statistics about the number and nature of the tests that were implemented:</p>
<ul class="simple">
<li><p>Number of tests: 87</p></li>
<li><p>Code coverage: 97.53%</p></li>
</ul>
<p>The tests were distributed along the following modules:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">Module</th>
<th align="center">Number of tests</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Algorithms</td>
<td align="center">3</td>
</tr>
<tr>
<td align="left">Git Wrapper</td>
<td align="center">12</td>
</tr>
<tr>
<td align="left">Listener</td>
<td align="center">5</td>
</tr>
<tr>
<td align="left">Mappings</td>
<td align="center">7</td>
</tr>
<tr>
<td align="left">Ontology Synchronizer</td>
<td align="center">5</td>
</tr>
<tr>
<td align="left">Operations</td>
<td align="center">5</td>
</tr>
<tr>
<td align="left">Triple Info</td>
<td align="center">14</td>
</tr>
<tr>
<td align="left">Triplestore Manager</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left">Webhook</td>
<td align="center">8</td>
</tr>
<tr>
<td align="left">Wikibase Adapter</td>
<td align="center">27</td>
</tr>
</tbody>
</table></div>
</div>
<div class="section" id="requirements-analysis">
<h2>Requirements analysis<a class="headerlink" href="#requirements-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="functional-requirements">
<h3>Functional requirements<a class="headerlink" href="#functional-requirements" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">Code</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">FR1</td>
<td align="left">The system will establish an entry point where the information about the updates of the ontologies will be received.</td>
</tr>
<tr>
<td align="center">FR2</td>
<td align="left">The system will process the information received from the Control Version System with respect to the updates in the ontologies.</td>
</tr>
<tr>
<td align="center">FR3</td>
<td align="left">The system will detect the modifications to perform in the triplestore based on the information about the updates previously processed.</td>
</tr>
<tr>
<td align="center">FR4</td>
<td align="left">The system will connect to a triplestore to reflect the changes from the ontologies.</td>
</tr>
<tr>
<td align="center">FR5</td>
<td align="left">The system will also execute the inverse synchronization: from changes made in the triplestore to the ontology files.</td>
</tr>
<tr>
<td align="center">FR6</td>
<td align="left">The system will use logging tools to detect anomalies in its internal functioning.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="non-functional-requirements">
<h3>Non-functional requirements<a class="headerlink" href="#non-functional-requirements" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">Code</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">NFR1</td>
<td align="left">Security: The system will receive update notifications from the VCS in a safe way with the use of RSA keys.</td>
</tr>
<tr>
<td align="center">NFR2</td>
<td align="left">Security: The system will use the OAuth protocol to update the triplestore.</td>
</tr>
<tr>
<td align="center">NFR3</td>
<td align="left">Compatibility: The system will be at least compatible with versions 3.6, 3.7 and 3.8 of the Python programming language.</td>
</tr>
<tr>
<td align="center">NFR4</td>
<td align="left">Mantenibility: The implementation of the system will follow the PEP8 standard.</td>
</tr>
<tr>
<td align="center">NFR5</td>
<td align="left">Quality: Code coverage of each new released version will be at least 90%.</td>
</tr>
<tr>
<td align="center">NFR6</td>
<td align="left">Extensibility: The system will facilitate the use of different triplestores where the ontologies can be stored.</td>
</tr>
</tbody>
</table></div>
</div>
<div class="section" id="annexes">
<h2>Annexes<a class="headerlink" href="#annexes" title="Permalink to this headline">¶</a></h2>
<p>In the following chapters we will provide several documents which provide additional information about the synchronization system. These documents are distributed amongst several sources but we will also keep them here to facilitate access to them. They may be written in either Spanish or English, depending on the target audience and the context that each document was originally written in.</p>
<div class="section" id="a-integracion-de-sistema-de-sincronizacion-con-github">
<h3>A: Integración de sistema de sincronización con GitHub<a class="headerlink" href="#a-integracion-de-sistema-de-sincronizacion-con-github" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><em>Versión especializada en el entorno de despliegue de La Universidad de Murcia. Se recomienda abrir el manual en una pestaña del propio navegador donde se tiene abierta la cuenta de GitHub y para no perder el manual cada vez que se va a hacer click en un enlace realizarlo de modo que se abra en otra pestaña.</em>
Para realizar la integración del sistema de sincronización con el sistema de control de versiones de la ontología (GitHub) vamos a crear un <strong>webhook</strong> en el repositorio y un <strong>token de acceso personal</strong> para nuestro usuario.</p>
</div></blockquote>
<div class="section" id="creacion-del-webhook">
<h4>Creación del webhook<a class="headerlink" href="#creacion-del-webhook" title="Permalink to this headline">¶</a></h4>
<p>Un webhook es una dirección web a la que GitHub mandará información cada vez que se produzca un cambio, en esta dirección estará escuchando el servicio de sincronización. Entonces,</p>
<ol>
<li><p>Ir al repositorio donde está la ontología (<a class="reference external" href="https://github.com/HerculesCRUE/ib-hercules-ontology">ib-hercules-ontology</a>) (https://github.com/HerculesCRUE/ib-hercules-ontology).</p></li>
<li><p>Acceder a la pestaña de <a class="reference external" href="https://github.com/HerculesCRUE/ib-hercules-ontology/settings">settings</a> (https://github.com/HerculesCRUE/ib-hercules-ontology/settings).</p></li>
<li><p>En el menú lateral izquierdo accederemos al elemento <code class="docutils literal notranslate"><span class="pre">Webhooks</span></code>. Y aremos click en <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">webhook</span></code> (situado en la parte superior derecha de la pantalla). Seguramente nos pedirá que introduzcamos nuestra contraseña, no pasa nada es el comportamiento esperado ya que estamos realizando una acción <em>sensible</em>.</p></li>
<li><p>Ahora se debería de mostrar un formulario donde introduciremos los siguientes datos:</p>
<p><strong>Payload URL:</strong> <code class="docutils literal notranslate"><span class="pre">http://herc-iz-back-desa.atica.um.es:5000/postreceive</span></code></p>
<p><strong>Content type:</strong> <code class="docutils literal notranslate"><span class="pre">aplication/json</span></code></p>
<p><strong>Secret:</strong> <code class="docutils literal notranslate"><span class="pre">ZE24JoxmzfS8TnEnmX4lLG4vIfUbjJLF</span></code></p>
<p><strong>Which events would you like to trigger this webhook?:</strong> <code class="docutils literal notranslate"><span class="pre">Just</span> <span class="pre">the</span> <span class="pre">push</span> <span class="pre">event</span></code></p>
<p><strong>Active:</strong> Seleccionar esta casilla si no está ya seleccionada
Una vez realizados estos pasos nos aparecerá una vista con el webhook creado. Si el icono que precede a la url del webhook es una señal de warning no pasa nada, es que aún no se ha configurado el sistema de sincronización para atender a los datos enviados por ese webhook.</p>
</li>
</ol>
</div>
<div class="section" id="creacion-del-token-de-acceso-personal">
<h4>Creación del token de acceso personal<a class="headerlink" href="#creacion-del-token-de-acceso-personal" title="Permalink to this headline">¶</a></h4>
<p>Un token de acceso personal es como una llave para autorizar sistemas externos a github a interactuar con el sistema. Para crear el token personal debemos de seguir los siguientes pasos:</p>
<ol>
<li><p>Entramos en nuestra cuenta de github y accedemos a nuestros <a class="reference external" href="https://github.com/settings/profile">settings</a>(https://github.com/settings/profile).</p></li>
<li><p>En el menú lateral izquierdo, hacemos click en <code class="docutils literal notranslate"><span class="pre">Developer</span> <span class="pre">settings</span></code> y de nuevo hacemos click en <code class="docutils literal notranslate"><span class="pre">Personal</span> <span class="pre">access</span> <span class="pre">tokens</span></code>. Si no se encuentra se puede acceder directamente desde este <a class="reference external" href="https://github.com/settings/tokens">enlace</a>(https://github.com/settings/tokens).</p></li>
<li><p>Realizamos click en el botón de <code class="docutils literal notranslate"><span class="pre">Generate</span> <span class="pre">new</span> <span class="pre">token</span></code>.</p></li>
<li><p>Nos debería de aparecer un formulario que rellenaremos con los siguientes datos:</p>
<p><strong>Note:</strong> <code class="docutils literal notranslate"><span class="pre">token_sincronización</span></code></p>
<p><strong>Select scopes:</strong> Aquí seleccionaremos todos menos: <code class="docutils literal notranslate"><span class="pre">delete:packages</span></code> y <code class="docutils literal notranslate"><span class="pre">delete_repo</span></code></p>
</li>
<li><p><strong>ATENCIÓN!</strong> Ahora haremos click en <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">token</span></code> y a continuación se nos mostrará el token. Hay que asegurarse de guardarlo en algún sitio y asegurarse dos veces que está bien guardado pues no podremos acceder nunca más al contenido de este token desde GitHub. A demás es conveniente tenerlo a mano ya que usaremos este token en el siguiente paso.</p></li>
</ol>
<p>Una vez realizados estos pasos ya tenemos nuestro token creado, ahora tenemos que configurarlo en el repositorio de la ontología (<a class="reference external" href="https://github.com/HerculesCRUE/ib-hercules-ontology">ib-hercules-ontology</a>) (https://github.com/HerculesCRUE/ib-hercules-ontology).</p>
</div>
<div class="section" id="configuracion-del-token-de-acceso">
<h4>Configuración del token de acceso<a class="headerlink" href="#configuracion-del-token-de-acceso" title="Permalink to this headline">¶</a></h4>
<p>Para realizar la configuración del token de acceso como secreto de nuestro repositorio de la ontología deberemos de:</p>
<ol>
<li><p>Acceder a la configuración de <code class="docutils literal notranslate"><span class="pre">Secrets</span></code> del repositorio de la ontología. Se puede acceder directamente haciendo click <a class="reference external" href="https://github.com/HerculesCRUE/ib-hercules-ontology/settings/secrets">aquí</a> (https://github.com/HerculesCRUE/ib-hercules-ontology/settings/secrets).</p></li>
<li><p>Hacemos click en <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">a</span> <span class="pre">new</span> <span class="pre">secret</span></code> y se despliega un formulario donde introduciremos:</p>
<p><strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">WESOBOT_ACCESS_TOKEN</span></code></p>
<p><strong>Value:</strong> Aquí deberemos de introducir el token de acceso personal que generamos antes.</p>
</li>
<li><p>Finalmente hacemos click en <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">secret</span></code> y debería de crearse.
Con esto ya habremos configurado nuestro repositorio para mandar los eventos de cambios al sistema de sincronización que mantiene la ontología actualizada en wikibase.</p></li>
</ol>
</div>
</div>
<div class="section" id="b-system-manual">
<h3>B: System manual<a class="headerlink" href="#b-system-manual" title="Permalink to this headline">¶</a></h3>
<p>In this annex we will detail how to launch the synchronization system locally with the sources given in the <a class="reference external" href="https://github.com/weso/hercules-sync">original repo</a>.</p>
<div class="section" id="defining-a-webhook-in-the-source-repo">
<h4>Defining a webhook in the source repo<a class="headerlink" href="#defining-a-webhook-in-the-source-repo" title="Permalink to this headline">¶</a></h4>
<p>In order to perform the synchronization automatically, a webhook must be created in the original repository where the ontology is stored. This webhook will be launched whenever a new push event occurs in the repo, and the synchronization service will be called to sync the changes with the wikibase instance. When creating a new webhook, the payload url must point to the URL where this server will be available. It is also important to define a secret key that will be used to accept only requests from the source repo and not from other ones. An example configuration will look like this one:
<img alt="docs/images/webhook_example.png" src="docs/images/webhook_example.png" /></p>
</div>
</div>
<div class="section" id="launching-the-app-with-docker">
<h3>Launching the app with Docker<a class="headerlink" href="#launching-the-app-with-docker" title="Permalink to this headline">¶</a></h3>
<p>In order to execute the app you need to set the following configuration in the docker-compose.yml file:</p>
<ul class="simple">
<li><p>GITHUB_OAUTH: Github token with access to read the repository where the ontology is stored. This token will be used to download the modified files through the GitHub API. For more information, see <a class="reference external" href="https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line">the official GitHub page about creating a personal access token</a>.</p></li>
<li><p>WBAPI: Endpoint of the target Wikibase instance API where the ontology will be sincronized. E.g. https://hercules-demo.wiki.opencura.com/w/api.php</p></li>
<li><p>WBSPARQL: SPARQL endpoint of the target wikibase. E.g. https://hercules-demo.wiki.opencura.com/query/sparql</p></li>
<li><p>WBUSER: Username of the user that will perform the synchronization operation in the target wikibase.</p></li>
<li><p>WBPASS: Password of the user defined by the username stated above.</p></li>
<li><p>WEBHOOK_SECRET: Secret key of the webhook created in the previous step.</p></li>
</ul>
<p>After the configuration is set, the following command must be executed:
<code class="docutils literal notranslate"><span class="pre">docker-compose</span> <span class="pre">up</span> <span class="pre">-d</span></code></p>
<p>After the command is executed, the synchronization system will be active waiting for changes in the ontology to be synchronized.</p>
</div>
</div>
<div class="section" id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">Term</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">OAuth</td>
<td>Authorization protocol that describes how unrelated servers can safely allow authorized access between them.</td>
</tr>
<tr>
<td align="left">RSA</td>
<td>Public-key cryptosystem used for secure data transmission.</td>
</tr>
<tr>
<td align="left">Triplestore</td>
<td>Specific type of database designed for the storage and retrieval of triples with the use of semantic queries.</td>
</tr>
<tr>
<td align="left">Version Control System</td>
<td>Software tool that helps a software team with the management of changes to source code.</td>
</tr>
</tbody>
</table></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Documentation of the hercules_sync system" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Web Semantics Oviedo

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>